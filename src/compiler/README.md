# AbbyScript - JavaScript-like Language for EVM

AbbyScript is a simple, JavaScript-inspired language that compiles to EVM bytecode.

## Language Features

### Variables and Types
```javascript
let x = 42;           // Number literals
let y = 0xFF;         // Hex literals
let result = x + y;   // Arithmetic operations
```

### Functions
```javascript
function add(a, b) {
    return a + b;
}

function fibonacci(n) {
    if (n <= 1) {
        return n;
    }
    return fibonacci(n - 1) + fibonacci(n - 2);
}
```

### Control Flow
```javascript
// If statements
if (x > 0) {
    return x;
} else {
    return -x;
}

// While loops
let i = 0;
while (i < 10) {
    i = i + 1;
}

// For loops
for (let i = 0; i < 10; i++) {
    // loop body
}
```

### Storage Operations
```javascript
// Storage read/write (persistent state)
storage.set(0, 42);
let value = storage.get(0);

// Memory operations (temporary)
memory.store(0, value);
let temp = memory.load(0);
```

### Built-in Functions
```javascript
// Hash functions
let hash = keccak256("hello world");

// Assertions
assert(x > 0, "x must be positive");

// Logging (emits EVM logs)
log("Debug message", x, y);
```

### Example Programs

#### Simple Calculator
```javascript
function main() {
    let a = 10;
    let b = 5;
    
    let sum = a + b;        // 15
    let diff = a - b;       // 5
    let prod = a * b;       // 50
    let quot = a / b;       // 2
    
    return sum;
}
```

#### Storage Counter
```javascript
function increment() {
    let count = storage.get(0);
    count = count + 1;
    storage.set(0, count);
    return count;
}

function getCount() {
    return storage.get(0);
}
```

#### Conditional Logic
```javascript
function max(a, b) {
    if (a > b) {
        return a;
    } else {
        return b;
    }
}

function factorial(n) {
    if (n <= 1) {
        return 1;
    }
    return n * factorial(n - 1);
}
```

## Compilation Process

1. **Lexer**: Tokenizes source code into keywords, identifiers, operators, etc.
2. **Parser**: Builds an Abstract Syntax Tree (AST) from tokens
3. **Code Generator**: Transforms AST into EVM bytecode
4. **Optimizer**: (Future) Optimizes the generated bytecode

## Usage

```bash
# Compile AbbyScript to bytecode
cargo run -- compile --file program.abs

# Compile and execute immediately
cargo run -- compile --file program.abs --execute

# Interactive compilation
cargo run -- compile --interactive
```

## Language Grammar (Simplified)

```
Program         → Statement*
Statement       → VarDecl | FuncDecl | ExprStmt | IfStmt | WhileStmt | ReturnStmt
VarDecl         → "let" IDENTIFIER "=" Expression ";"
FuncDecl        → "function" IDENTIFIER "(" Parameters? ")" Block
ExprStmt        → Expression ";"
IfStmt          → "if" "(" Expression ")" Block ("else" Block)?
WhileStmt       → "while" "(" Expression ")" Block
ReturnStmt      → "return" Expression? ";"
Block           → "{" Statement* "}"
Expression      → Assignment
Assignment      → IDENTIFIER "=" Assignment | LogicalOr
LogicalOr       → LogicalAnd ("||" LogicalAnd)*
LogicalAnd      → Equality ("&&" Equality)*
Equality        → Comparison (("!=" | "==") Comparison)*
Comparison      → Term ((">" | ">=" | "<" | "<=") Term)*
Term            → Factor (("-" | "+") Factor)*
Factor          → Unary (("/" | "*" | "%") Unary)*
Unary           → ("!" | "-") Unary | Call
Call            → Primary ("(" Arguments? ")")*
Primary         → NUMBER | IDENTIFIER | "(" Expression ")"
```
